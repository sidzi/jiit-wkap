import sys
import itertools

PY3 = sys.version_info >= (3,)
PY2 = not PY3

if PY2:
    basestring = basestring
    from StringIO import StringIO

    BytesIO = StringIO
    func_code = lambda o: o.func_code
    func_globals = lambda o: o.func_globals
    im_func = lambda o: o.im_func
    iteritems = lambda o: o.iteritems()
    long_type = long
    maxsize = sys.maxint
    unichr = unichr
    unicode = unicode
    bytes = str
    filterfalse = itertools.ifilterfalse

    exec ("""def reraise(tp, value, tb=None):
    raise tp, value, tb""")

if PY3:
    basestring = str
    func_code = lambda o: o.__code__
    func_globals = lambda o: o.__globals__
    im_func = lambda o: o.__func__
    iteritems = lambda o: o.items()
    long_type = int
    maxsize = sys.maxsize
    unichr = chr
    unicode = str
    bytes = bytes
    filterfalse = itertools.filterfalse

    def reraise(tp, value, tb=None):
        if value.__traceback__ is not tb:
            raise value.with_traceback(tb)
        raise value
